import React, { useContext, useState } from "react";
import { Link } from "react-router-dom";
import AuthContext from "contexts/auth";
import Media from "react-media";
import LargeFormatMenu from "./large-format";
import SmallFormatMenu from "./small-format";
import "./index.scss";

export default () => {
  const auth = useContext(AuthContext);
  const [navOpen, setNavOpen] = useState(false);

  const menuProps = Object.assign(
    {
      navOpen,
      setNavOpen,
    },
    auth.isAuthenticated()
      ? {
          primary: [
            {
              component: Link,
              props: { to: "/help" },
              label: "Need Help?",
            },
            {
              component: Link,
              props: { to: "/training" },
              label: "Resources",
            },
          ],
          secondary: [
            {
              component: Link,
              props: { to: "/account" },
              label: "Edit Account",
            },
            {
              component: "button",
              props: {
                type: "button",
                onClick: () => auth.logout(),
              },
              label: "Logout",
            },
          ],
        }
      : {
          primary: [
            {
              component: Link,
              props: { to: "/login" },
              label: "Login",
            },
          ],
          secondary: [],
        }
  );

  return (
    <header className="global-nav">
      <h1 className="global-nav__title">
        <Link to="/">
          <svg width="138" height="24" xmlns="http://www.w3.org/2000/svg">
            <g fill="none" fillRule="evenodd">
              <path
                d="M19.344 18v-6.704a9.986 9.986 0 00-.064-1.064l3.104 6c.096.187.225.328.388.424.163.096.348.144.556.144h.368c.208 0 .393-.048.556-.144.163-.096.292-.237.388-.424l3.088-5.992c-.032.379-.048.73-.048 1.056V18h2.384V6.344H28c-.117 0-.22.003-.308.008a.788.788 0 00-.236.048.537.537 0 00-.188.124.978.978 0 00-.164.236l-2.992 5.888c-.107.208-.21.423-.312.644-.101.221-.197.45-.288.684a15.4 15.4 0 00-.284-.672c-.099-.219-.201-.43-.308-.632l-3-5.912a.978.978 0 00-.164-.236.537.537 0 00-.188-.124.788.788 0 00-.236-.048 5.168 5.168 0 00-.308-.008H16.96V18h2.384zm16.304.128c.283 0 .58-.02.892-.06.312-.04.624-.112.936-.216.312-.104.616-.248.912-.432.296-.184.572-.423.828-.716l-.72-.888a.513.513 0 00-.448-.216.93.93 0 00-.428.104l-.448.232a3.753 3.753 0 01-.556.232c-.208.07-.456.104-.744.104-.539 0-.979-.156-1.32-.468-.341-.312-.552-.815-.632-1.508h4.784a.806.806 0 00.276-.04.335.335 0 00.172-.144.722.722 0 00.088-.28c.016-.117.024-.27.024-.456 0-.597-.092-1.132-.276-1.604a3.396 3.396 0 00-.768-1.196 3.278 3.278 0 00-1.176-.744 4.272 4.272 0 00-1.508-.256c-.635 0-1.204.11-1.708.328a3.885 3.885 0 00-1.288.888 3.882 3.882 0 00-.816 1.304 4.381 4.381 0 00-.284 1.576c0 .736.11 1.381.332 1.936.221.555.523 1.019.904 1.392a3.76 3.76 0 001.336.844c.51.19 1.055.284 1.636.284zm1.392-5.272h-3.096c.085-.507.261-.895.528-1.164.267-.27.637-.404 1.112-.404.267 0 .493.045.68.136.187.09.337.21.452.356.115.147.197.313.248.5.05.187.076.379.076.576zm6.096 5.272c.283 0 .545-.028.788-.084a3.11 3.11 0 001.268-.612c.181-.144.355-.304.52-.48l.192.632a.555.555 0 00.22.312c.104.07.233.104.388.104h1.536V6.024h-2.48v4.2a3.129 3.129 0 00-.804-.492c-.296-.125-.657-.188-1.084-.188-.528 0-1.01.11-1.448.328a3.362 3.362 0 00-1.124.908 4.227 4.227 0 00-.724 1.376 5.602 5.602 0 00-.256 1.724c0 .672.076 1.27.228 1.796.152.525.361.97.628 1.332.267.363.584.64.952.832.368.192.768.288 1.2.288zM44 16.224c-.197 0-.376-.04-.536-.12a1.04 1.04 0 01-.412-.396 2.274 2.274 0 01-.268-.724 5.373 5.373 0 01-.096-1.104c0-.453.04-.84.12-1.16.08-.32.19-.58.332-.78.141-.2.308-.345.5-.436.192-.09.403-.136.632-.136.24 0 .468.041.684.124.216.083.42.228.612.436v3.52a3.01 3.01 0 01-.324.336 1.73 1.73 0 01-.752.388c-.147.035-.31.052-.492.052zm7.296-7.352c.208 0 .404-.039.588-.116.184-.077.345-.181.484-.312.139-.13.248-.283.328-.456.08-.173.12-.359.12-.556 0-.203-.04-.392-.12-.568a1.497 1.497 0 00-.812-.776 1.549 1.549 0 00-1.156 0 1.499 1.499 0 00-.788.776 1.396 1.396 0 00-.116.568c0 .197.039.383.116.556.077.173.184.325.32.456.136.13.292.235.468.312.176.077.365.116.568.116zM52.528 18V9.704h-2.48V18h2.48zm5.264.128c.283 0 .573-.02.872-.06a4.48 4.48 0 00.892-.216 3.918 3.918 0 001.676-1.148l-.72-.888a.513.513 0 00-.448-.216.599.599 0 00-.372.112l-.324.244c-.117.088-.26.168-.428.24-.168.072-.396.108-.684.108-.539 0-.961-.213-1.268-.64-.307-.427-.46-1.037-.46-1.832 0-.379.035-.719.104-1.02.07-.301.176-.556.32-.764a1.46 1.46 0 01.548-.48c.221-.112.484-.168.788-.168.245 0 .45.03.616.088.165.059.31.124.432.196l.332.196c.099.059.21.088.332.088a.477.477 0 00.296-.08c.07-.053.141-.125.216-.216l.656-.872a4.108 4.108 0 00-1.328-.912c-.49-.208-1.061-.312-1.712-.312-.677 0-1.273.11-1.788.328a3.682 3.682 0 00-1.296.9c-.35.381-.613.832-.792 1.352a5.124 5.124 0 00-.268 1.676c0 .683.103 1.29.308 1.824.205.533.483.983.832 1.348.35.365.755.644 1.216.836.461.192.945.288 1.452.288zm6.608 0c.283 0 .54-.023.772-.068.232-.045.45-.115.656-.208.205-.093.404-.207.596-.34.192-.133.392-.288.6-.464l.176.456c.08.203.18.336.3.4s.297.096.532.096h1.136v-5.184c0-.475-.075-.912-.224-1.312-.15-.4-.364-.745-.644-1.036a2.918 2.918 0 00-1.024-.68 3.592 3.592 0 00-1.356-.244c-.699 0-1.353.108-1.964.324a5.043 5.043 0 00-1.668.988l.448.776c.07.123.164.225.284.308a.75.75 0 00.436.124c.192 0 .357-.032.496-.096s.281-.136.428-.216c.147-.08.313-.152.5-.216a2.26 2.26 0 01.72-.096c.368 0 .652.108.852.324.2.216.3.567.3 1.052v.352c-.95.021-1.736.117-2.36.288-.624.17-1.12.383-1.488.636-.368.253-.627.535-.776.844-.15.31-.224.61-.224.904 0 .373.059.703.176.988.117.285.284.524.5.716.216.192.479.337.788.436.31.099.653.148 1.032.148zm.784-1.64c-.299 0-.525-.057-.68-.172-.155-.115-.232-.313-.232-.596 0-.144.036-.277.108-.4.072-.123.201-.232.388-.328s.44-.176.76-.24.728-.107 1.224-.128v1.152c-.245.25-.488.432-.728.544-.24.112-.52.168-.84.168zM73.408 18v-5.088c.373-.693.885-1.04 1.536-1.04.187 0 .341.012.464.036.123.024.23.036.32.036a.434.434 0 00.256-.068c.064-.045.107-.124.128-.236l.32-1.824c-.23-.181-.533-.272-.912-.272a2.08 2.08 0 00-1.24.408c-.379.272-.72.643-1.024 1.112l-.136-.776a1.623 1.623 0 00-.076-.272.427.427 0 00-.128-.18.54.54 0 00-.208-.1 1.255 1.255 0 00-.308-.032h-1.472V18h2.48zm7.792.128c.283 0 .58-.02.892-.06.312-.04.624-.112.936-.216.312-.104.616-.248.912-.432.296-.184.572-.423.828-.716l-.72-.888a.513.513 0 00-.448-.216.93.93 0 00-.428.104l-.448.232a3.753 3.753 0 01-.556.232c-.208.07-.456.104-.744.104-.539 0-.979-.156-1.32-.468-.341-.312-.552-.815-.632-1.508h4.784a.806.806 0 00.276-.04.335.335 0 00.172-.144.722.722 0 00.088-.28c.016-.117.024-.27.024-.456 0-.597-.092-1.132-.276-1.604a3.396 3.396 0 00-.768-1.196 3.278 3.278 0 00-1.176-.744 4.272 4.272 0 00-1.508-.256c-.635 0-1.204.11-1.708.328a3.885 3.885 0 00-1.288.888 3.882 3.882 0 00-.816 1.304 4.381 4.381 0 00-.284 1.576c0 .736.11 1.381.332 1.936.221.555.523 1.019.904 1.392a3.76 3.76 0 001.336.844c.51.19 1.055.284 1.636.284zm1.392-5.272h-3.096c.085-.507.261-.895.528-1.164.267-.27.637-.404 1.112-.404.267 0 .493.045.68.136.187.09.337.21.452.356.115.147.197.313.248.5.05.187.076.379.076.576zm11.96 5.272c.944 0 1.75-.152 2.42-.456A4.905 4.905 0 0098.68 16.4l-.608-.664a.321.321 0 00-.232-.104c-.085 0-.173.04-.264.12a5.068 5.068 0 01-.604.468 3.2 3.2 0 01-.648.324 3.778 3.778 0 01-.756.188c-.272.04-.579.06-.92.06-.56 0-1.083-.101-1.568-.304a3.542 3.542 0 01-1.26-.884 4.222 4.222 0 01-.84-1.42c-.205-.56-.308-1.197-.308-1.912 0-.693.103-1.32.308-1.88.205-.56.492-1.035.86-1.424a3.77 3.77 0 011.316-.9c.51-.21 1.07-.316 1.684-.316.341 0 .643.025.904.076.261.05.49.113.688.188.197.075.368.155.512.24.144.085.27.165.376.24.107.075.199.137.276.188.077.05.15.076.22.076.09 0 .16-.017.208-.052a.55.55 0 00.128-.132l.504-.712A5.51 5.51 0 0097.028 6.8c-.61-.261-1.337-.392-2.18-.392-.853 0-1.633.143-2.34.428a5.28 5.28 0 00-1.82 1.204 5.43 5.43 0 00-1.18 1.856c-.28.72-.42 1.512-.42 2.376 0 .864.13 1.656.392 2.376.261.72.63 1.337 1.104 1.852a4.927 4.927 0 001.72 1.2c.672.285 1.421.428 2.248.428zm9.232-.016a5.302 5.302 0 001.756-.304c.28-.101.543-.23.788-.388.245-.157.456-.343.632-.556l-.4-.52a.313.313 0 00-.272-.136c-.09 0-.199.041-.324.124a5.095 5.095 0 01-.468.268c-.187.096-.41.185-.668.268a3.051 3.051 0 01-.924.124c-.384 0-.73-.063-1.04-.188a2.116 2.116 0 01-.8-.568c-.224-.253-.4-.57-.528-.948-.128-.379-.197-.824-.208-1.336h5.392c.133 0 .224-.037.272-.112.048-.075.072-.224.072-.448 0-.576-.084-1.09-.252-1.54a3.21 3.21 0 00-.7-1.136 3.017 3.017 0 00-1.064-.704 3.618 3.618 0 00-1.344-.244c-.587 0-1.115.103-1.584.308-.47.205-.867.488-1.192.848-.325.36-.575.785-.748 1.276a4.722 4.722 0 00-.26 1.584c0 .699.096 1.317.288 1.856.192.539.46.99.804 1.356.344.365.752.643 1.224.832.472.19.988.284 1.548.284zm2-5.048h-4.408c.096-.704.341-1.255.736-1.652.395-.397.936-.596 1.624-.596.325 0 .615.055.868.164.253.11.468.264.644.464s.31.437.4.712c.09.275.136.577.136.908zm4.52 4.936v-5.968c.31-.347.647-.621 1.012-.824a2.394 2.394 0 011.18-.304c.576 0 1.004.17 1.284.508.28.339.42.815.42 1.428V18h1.424v-5.16a4.23 4.23 0 00-.176-1.256 2.756 2.756 0 00-.516-.972 2.268 2.268 0 00-.848-.624 2.926 2.926 0 00-1.172-.22c-.57 0-1.073.12-1.508.36-.435.24-.828.555-1.18.944l-.112-.88c-.053-.197-.181-.296-.384-.296h-.848V18h1.424zm9.928.128c.368 0 .725-.065 1.072-.196.347-.13.643-.31.888-.54l-.416-.68c-.059-.09-.125-.136-.2-.136a.267.267 0 00-.148.06c-.056.04-.124.084-.204.132-.08.048-.175.092-.284.132-.11.04-.239.06-.388.06a.866.866 0 01-.64-.248c-.165-.165-.248-.419-.248-.76v-4.864h2.32v-1.032h-2.32V7.264h-.72a.33.33 0 00-.224.076.303.303 0 00-.104.196l-.328 2.504-1.328.168v.568c0 .107.03.185.088.236.059.05.13.076.216.076h.976v4.96c0 .672.172 1.187.516 1.544.344.357.836.536 1.476.536zm6.8-.016a5.302 5.302 0 001.756-.304c.28-.101.543-.23.788-.388.245-.157.456-.343.632-.556l-.4-.52a.313.313 0 00-.272-.136c-.09 0-.199.041-.324.124a5.095 5.095 0 01-.468.268c-.187.096-.41.185-.668.268a3.051 3.051 0 01-.924.124c-.384 0-.73-.063-1.04-.188a2.116 2.116 0 01-.8-.568c-.224-.253-.4-.57-.528-.948-.128-.379-.197-.824-.208-1.336h5.392c.133 0 .224-.037.272-.112.048-.075.072-.224.072-.448 0-.576-.084-1.09-.252-1.54a3.21 3.21 0 00-.7-1.136 3.017 3.017 0 00-1.064-.704 3.618 3.618 0 00-1.344-.244c-.587 0-1.115.103-1.584.308-.47.205-.867.488-1.192.848-.325.36-.575.785-.748 1.276a4.722 4.722 0 00-.26 1.584c0 .699.096 1.317.288 1.856.192.539.46.99.804 1.356.344.365.752.643 1.224.832.472.19.988.284 1.548.284zm2-5.048h-4.408c.096-.704.341-1.255.736-1.652.395-.397.936-.596 1.624-.596.325 0 .615.055.868.164.253.11.468.264.644.464s.31.437.4.712c.09.275.136.577.136.908zm4.52 4.936v-5.16c.224-.55.503-.968.836-1.256.333-.288.748-.432 1.244-.432.277 0 .493.025.648.076.155.05.27.076.344.076.128 0 .21-.067.248-.2l.184-1.064a2.12 2.12 0 00-1.112-.288c-.55 0-1.028.159-1.436.476-.408.317-.75.759-1.028 1.324l-.096-1.264c-.021-.144-.061-.245-.12-.304s-.165-.088-.32-.088h-.816V18h1.424z"
                fill="#236C9E"
                fillRule="nonzero"
              />
              <path d="M0 4h16v16H0z" />
              <path
                d="M8 11.667a1.667 1.667 0 110-3.334 1.667 1.667 0 010 3.334m0-6.334A4.667 4.667 0 003.333 10C3.333 13.5 8 18.667 8 18.667S12.667 13.5 12.667 10A4.667 4.667 0 008 5.333z"
                fill="#A4AEC1"
              />
            </g>
          </svg>
        </Link>
      </h1>
      <nav className="global-nav__links">
        {/*
          Causes console error in dev env only due to this issue
          https://github.com/ReactTraining/react-media/issues/139
        */}
        <Media
          queries={{
            small: "(max-width: 767px)",
          }}
        >
          {(matches) => (
            <React.Fragment>
              {matches.small && <SmallFormatMenu {...menuProps} />}
              {!matches.small && <LargeFormatMenu {...menuProps} />}
            </React.Fragment>
          )}
        </Media>
      </nav>
    </header>
  );
};
